<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Completa il Testo</title>
<style>
  .word {
    border: 1px solid #000;
    padding: 5px;
    cursor: pointer;
    display: inline-block;
    margin: 5px;
    background-color: #f9f9f9;
    position: relative;
    z-index: 1;
  }
  .blank {
    border: 2px solid #000; 
    min-width: 80px;
    min-height: 30px;
    display: inline-block;
    margin: 5px;
    position: relative;
    line-height: 30px; /* Ensure vertical alignment */
  }
  .remove {
    color: red;
    cursor: pointer;
    position: absolute;
    top: -10px;
    right: -10px;
    font-size: 14px;
    display: none;
  }
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui-touch-punch/0.2.3/jquery.ui.touch-punch.min.js"></script>
<script>
$(function() {
  $(".word").draggable({
    revert: "invalid",
    containment: "document",
    start: function() {
      $(".blank").each(function() {
        if ($(this).text().trim() === $(this).data("word")) {
          $(this).data("word", "");
          $(".word").each(function() {
            if ($(this).text() === $(this).text().trim()) {
              $(this).css("visibility", "visible");
            }
          });
        }
      });
    }
  });

  $(".blank").droppable({
    accept: ".word",
    drop: function(event, ui) {
      var droppedElement = ui.draggable;
      var blankElement = $(this);
      var previousContent = blankElement.data("word");
    
      // Make previously dropped word visible again
      if (previousContent !== "") {
        $(".word").filter(function() {
          return $(this).text() === previousContent;
        }).css("visibility", "visible");
      }

      // Update content in the blank
      blankElement.empty().append(droppedElement.text()).css("line-height", "30px");
      blankElement.data("word", droppedElement.text());
      droppedElement.css("visibility", "hidden");

      // Show the remove button
      var removeButton = $('<span class="remove">X</span>').click(function() {
        $(this).parent().empty().data("word", "");
        droppedElement.css("visibility", "visible");
      });
      blankElement.append(removeButton);
    }
  });
});
</script>
</head>
<body>
<h3>Completa il Testo</h3>
<p>La distillazione <span class="blank" data-word="" ondrop="drop(event)" ondragover="allowDrop(event)"></span> Ã¨ una tecnica di separazione di miscugli <span class="blank" data-word="" ondrop="drop(event)" ondragover="allowDrop(event)"></span>.</p>
<div class="word-pool">
  <span id="word1" class="word">semplice</span>
  <span id="word2" class="word">omogenei</span>
</div>
<p>V.3</p>
</body>
</html>
